@page "/divcards"
@using BlazorApp2.Data.Models;
@using System.Text.Json;
@inject IHttpClientFactory ClientFactory
@inject IConfiguration Configuration
<h3>Divination Cards</h3>

<table class="table ">
    <thead>
        <tr>
            <th>
                Name
            </th>
            <th>
                Cards Owned
            </th>
            <th>
                Max Stack
            </th>
            <th>
                Text
            </th>
            <th>
                Reward
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (DivinationCard card in divCardList)
        {
            <tr>
                <td>@card.baseType</td>
                <td style="background-color: @(card.stackSize >= card.maxStackSize ? "#6aa84f" : "#cc0000")">@card.stackSize</td>
                <td style="background-color: @(card.stackSize >= card.maxStackSize ? "#6aa84f" : "#cc0000")">@card.maxStackSize</td>
                <td>@card.cardText</td>
                <td>@card.rewardText</td>
            </tr>
        }
    </tbody>
</table>
@code {

    List<DivinationCard> divCardList = new List<DivinationCard>();

    protected override async Task OnInitializedAsync()
    {

        var request = new HttpRequestMessage(HttpMethod.Get, "https://blazorapi20230112152353.azurewebsites.net/api/DivinationCards");

        var client = ClientFactory.CreateClient();

        var response = await client.SendAsync(request);

        var cards = await response.Content.ReadFromJsonAsync<List<DivinationCard>>();
        divCardList = cards;
    }

}
